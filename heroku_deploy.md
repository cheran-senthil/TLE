#### Deployment steps

- clone this repository locally.
- Open terminal in /path/to/TLE/
- Get your `BOT_TOKEN` and export `BOT_TOKEN` as an environment variable following the instructions [here](README.md#final-steps)
- Install [Heroku CLI](https://devcenter.heroku.com/articles/heroku-cli)
- Login to heroku from terminal following the instructions [here](https://devcenter.heroku.com/articles/heroku-cli#getting-started).
- Run the following commands:
    - `heroku create -b heroku/python` (heroku will auto generate your app-name, notice the name)
    - `heroku buildpacks:add heroku-community/apt`
    - `heroku config:set BOT_TOKEN=$BOT_TOKEN PYTHONPATH=/app/.apt/usr/lib/python3/dist-packages GI_TYPELIB_PATH=/app/.apt/usr/lib/x86_64-linux-gnu/girepository-1.0`
    - `git push heroku master`
- Go to https://dashboard.heroku.com/apps/YOUR-APP-NAME/resources, Click on edit against worker => Turn on the switch => Confirm.
- view logs using `heroku logs`


#### Note for future updates

- Heroku's python3 is currently 3.6, for using version>=3.8, replace all "37" in heroku_run.sh by python version (3.7 -> 37).
- requirements.txt is generated by:
    - `poetry export -f requirements.txt -o requirements.txt`
    - remove all hash and ' \\'. The resulting file should look like current requirements.txt.
    - remove pygobject, as it causes `ERROR: Could not build wheels for pygobject which use PEP 517 and cannot be installed directly` in heroku.
- Don't change order of buildpacks (it somehow breaks installing pycairo) and Aptfile. A major problem with heroku apt packages is: some
packages are available at buildtime, but unavailable at runtime, more info [here](https://devcenter.heroku.com/articles/stack-packages). For this reason, many dependency packages don't get available at runtime unless you explicitly mention it in Aptfile e.g. having libgirepository1.0-dev in Aptfile doesn't install libgirepository-1.0-1 for runtime, as the latter package is pre-installed for build-time.